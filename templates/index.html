{% extends "base.html" %}

{% block content %}
<section class="search-section">
    <h2>Find a VC Fund</h2>
    <p>Enter fund or firm name to search SEC Form D filings.</p>
    <p id="how-to-use" class="how-to-use"><a href="https://substack.com/inbox/post/180813640" target="_blank">how it works â†’</a></p>
    
    <div class="search-container">
        <input 
            type="text" 
            id="firm-search"
            name="q" 
            placeholder="e.g. Lux Capital, Andreessen Horowitz, Sequoia"
            autocomplete="off"
            hx-get="/search"
            hx-trigger="keyup changed delay:150ms"
            hx-target="#search-results"
            hx-indicator="#search-spinner"
        >
        <span id="search-spinner" class="htmx-indicator">Searching...</span>
    </div>
    
    <div id="search-results"></div>
</section>

<div class="accent-bar"></div>
<script>
// Hide accent bar when search results appear
document.body.addEventListener('htmx:afterSwap', function(e) {
    if (e.detail.target.id === 'search-results') {
        var bar = document.querySelector('.accent-bar');
        bar.style.display = e.detail.target.innerHTML.trim() ? 'none' : 'block';
    }
});

// Hide "how to use" after first visit
(function() {
    var howTo = document.getElementById('how-to-use');
    if (localStorage.getItem('vcdoxxer_visited')) {
        howTo.style.display = 'none';
    } else {
        localStorage.setItem('vcdoxxer_visited', '1');
    }
})();
</script>
{% endblock %}

